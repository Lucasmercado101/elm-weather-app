"use strict";var _a,_b;"serviceWorker"in navigator&&(navigator.serviceWorker.register("worker.js").then(e=>{console.log("Service Worker Registered")}).catch(e=>{console.log("Error registering: Not on HTTPS")}),navigator.serviceWorker.addEventListener("message",e=>{e=e.data;"meteo"===e.type&&localStorage.setItem("WEATHER_DATA",e.data),"address"===e.type&&(null==e.data?localStorage.removeItem("ADDRESS_DATA"):localStorage.setItem("ADDRESS_DATA",e.data))}));const startAppWFlags=e=>Elm.Main.init({node:document.getElementById("root"),flags:e}),freshAppStart=()=>Elm.Main.init({node:document.getElementById("root"),flags:navigator.language||navigator.userLanguage}),cachedWeatherData=localStorage.getItem("WEATHER_DATA"),cachedAddressData=localStorage.getItem("ADDRESS_DATA"),theme=localStorage.getItem("THEME"),customThemes=localStorage.getItem("THEMES"),usingGeo=localStorage.getItem("USING_GEOLOCATION");let parsedTheme=null,parsedCustomThemes=null,usingGeoLocation=!1;const timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone;try{if(theme){const f=255*(parsedTheme=JSON.parse(theme)).primary.r,g=255*parsedTheme.primary.g,h=255*parsedTheme.primary.b;document.body.style.background=`rgb(${f}, ${g}, ${h})`}if(customThemes&&(parsedCustomThemes=JSON.parse(customThemes)),usingGeo&&(usingGeoLocation=JSON.parse(usingGeo)),cachedWeatherData&&cachedAddressData){const i=JSON.parse(cachedWeatherData),j=JSON.parse(cachedAddressData);main(startAppWFlags({posixTimeNow:Date.now(),cachedWeatherData:i,addressData:{country:j.address.country,city:null!=(_a=j.address.city)?_a:null,state:null!=(_b=j.address.state)?_b:null},usingGeoLocation:usingGeoLocation,language:navigator.language||navigator.userLanguage,theme:parsedTheme,customThemes:parsedCustomThemes,timezone:timeZone}))}else if(cachedWeatherData){const k=JSON.parse(cachedWeatherData);main(startAppWFlags({posixTimeNow:Date.now(),cachedWeatherData:k,usingGeoLocation:usingGeoLocation,language:navigator.language||navigator.userLanguage,theme:parsedTheme,customThemes:parsedCustomThemes,timezone:timeZone}))}else main(freshAppStart())}catch(e){main(freshAppStart())}function main(t){(navigator.onLine?t.ports.wentOnline:t.ports.wentOffline).send(null),window.addEventListener("online",()=>t.ports.wentOnline.send(null)),window.addEventListener("offline",()=>t.ports.wentOffline.send(null)),t.ports.checkIfIsOnline.subscribe(()=>{(navigator.onLine?t.ports.wentOnline:t.ports.wentOffline).send(null)}),t.ports.requestLocation.subscribe(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{localStorage.setItem("USING_GEOLOCATION","true"),t.ports.locationReceiver.send(e.coords)},e=>t.ports.errorObtainingCurrentPosition.send(e.code)):t.ports.noGeoLocationApiAvailableReceiver.send(null)}),t.ports.setNotUsingGeoLocation.subscribe(()=>{localStorage.removeItem("USING_GEOLOCATION")}),t.ports.changedTheme.subscribe(e=>{var[t,a,o]=e[0],[e,r,s]=e[1];localStorage.setItem("THEME",JSON.stringify({primary:{r:t,g:a,b:o},secondary:{r:e,g:r,b:s}}))}),t.ports.saveCustomThemes.subscribe(e=>{localStorage.setItem("THEMES",JSON.stringify(e))})}